{
  "name": "go",
  "aliases": "",
  "pattern": "*",
  "description": "Move in a direction",
  "code": [
    "// Smart go command - move in any available direction",
    "var currentLocation = Player.Location;",
    "if (currentLocation == null)",
    "{",
    "    notify(Player, \"You are not in any location.\");",
    "    return;",
    "}",
    "",
    "if (Args.Count != 1)",
    "{",
    "    // Show available exits if no direction given",
    "    var exits = Builtins.GetExitsFromRoom(currentLocation);",
    "    if (exits.Count == 0)",
    "    {",
    "        notify(Player, \"There are no exits from here.\");",
    "    }",
    "    else",
    "    {",
    "        var exitNames = new List<string>();",
    "        foreach (var exit in exits)",
    "        {",
    "            var direction = Builtins.GetProperty(exit.Id, \"direction\");",
    "            if (direction != null)",
    "            {",
    "                exitNames.Add(direction);",
    "            }",
    "        }",
    "        notify(Player, $\"Available exits: {string.Join(\", \", exitNames)}\");",
    "        notify(Player, \"Usage: go <direction>\");",
    "    }",
    "    return;",
    "}",
    "",
    "var direction = Args[0].ToString().ToLowerInvariant();",
    "var exits = Builtins.GetExitsFromRoom(currentLocation);",
    "GameObject exit = null;",
    "foreach (var e in exits)",
    "{",
    "    var exitDirection = Builtins.GetProperty(e.Id, \"direction\")?.ToString().ToLowerInvariant();",
    "    if (exitDirection == direction)",
    "    {",
    "        exit = e;",
    "        break;",
    "    }",
    "}",
    "",
    "if (exit == null)",
    "{",
    "    // Show available exits",
    "    var exitNames = new List<string>();",
    "    foreach (var e in exits)",
    "    {",
    "        var dir = Builtins.GetProperty(e.Id, \"direction\");",
    "        if (dir != null)",
    "        {",
    "            exitNames.Add(dir);",
    "        }",
    "    }",
    "    if (exitNames.Count > 0)",
    "    {",
    "        notify(Player, $\"There is no exit '{direction}'. Available exits: {string.Join(\", \", exitNames)}\");",
    "    }",
    "    else",
    "    {",
    "        notify(Player, \"There are no exits from here.\");",
    "    }",
    "    return;",
    "}",
    "",
    "var destination = Builtins.GetProperty(exit.Id, \"destination\");",
    "if (destination == null)",
    "{",
    "    notify(Player, \"That exit doesn't lead anywhere.\");",
    "    return;",
    "}",
    "",
    "// Move the player",
    "if (Builtins.MoveObject(Player.Id, destination))",
    "{",
    "    // Update player location",
    "    Player.Location = destination;",
    "    notify(Player, $\"You go {direction}.\");",
    "    Builtins.ShowRoom();",
    "}",
    "else",
    "{",
    "    notify(Player, \"You can't go that way.\");",
    "}"
  ]
}
